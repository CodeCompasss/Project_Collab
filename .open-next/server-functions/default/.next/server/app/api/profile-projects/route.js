(()=>{var e={};e.id=976,e.ids=[976],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},7462:(e,t,r)=>{"use strict";r.a(e,async(e,o)=>{try{r.d(t,{db:()=>d});var a=r(97329),n=r(72094),s=r(64939),i=r(13723),c=e([s,n]);if([s,n]=c.then?(await c)():c,a.config({path:".env.local"}),!process.env.DATABASE_URL)throw Error("âŒ DATABASE_URL not set in .env.local");let p=new s.Pool({connectionString:process.env.DATABASE_URL,ssl:{rejectUnauthorized:!1}}),d=(0,n.fd)(p,{schema:i});o()}catch(e){o(e)}})},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},13723:(e,t,r)=>{"use strict";r.r(t),r.d(t,{categories:()=>l,categoryOptionValues:()=>y,projectOptions:()=>g,projects:()=>u,teamMembers:()=>m,users:()=>d});var o=r(43402),a=r(79252),n=r(50033),s=r(29334),i=r(9253),c=r(14082),p=r(63431);let d=(0,o.cJ)("users",{uid:(0,a.yf)("uid",{length:255}).primaryKey(),userRole:(0,a.yf)("user_role",{length:50}).notNull()}),l=(0,o.cJ)("categories",{categoryId:(0,n.vX)("category_id").primaryKey(),category:(0,a.yf)("category",{length:100}).notNull()}),u=(0,o.cJ)("projects",{projectId:(0,n.vX)("project_id").primaryKey(),projectName:(0,a.yf)("project_name",{length:255}).notNull(),projectDescription:(0,s.Qq)("project_description"),projectLink:(0,a.yf)("project_link",{length:255}),createdAt:(0,i.vE)("created_at").defaultNow(),createdByUid:(0,a.yf)("created_by_uid",{length:255}),customDomain:(0,a.yf)("custom_domain",{length:255}),contactInstagram:(0,a.yf)("contact_instagram",{length:255}),contactLinkedIn:(0,a.yf)("contact_linkedin",{length:255}),contactEmail:(0,a.yf)("contact_email",{length:255}),contactWhatsApp:(0,a.yf)("contact_whatsapp",{length:255})},e=>({fk_createdBy:(0,c.mt)({columns:[e.createdByUid],foreignColumns:[d.uid]})})),m=(0,o.cJ)("team_members",{memberId:(0,n.vX)("member_id").primaryKey(),projectId:(0,p.nd)("project_id"),name:(0,a.yf)("name",{length:100}),linkedin:(0,a.yf)("linkedin",{length:255})},e=>({fk_projectId:(0,c.mt)({columns:[e.projectId],foreignColumns:[u.projectId]})})),y=(0,o.cJ)("category_option_values",{optionId:(0,n.vX)("option_id").primaryKey(),optionName:(0,a.yf)("option_name",{length:255}).notNull(),categoryId:(0,p.nd)("category_id")},e=>({fk_categoryId:(0,c.mt)({columns:[e.categoryId],foreignColumns:[l.categoryId]})})),g=(0,o.cJ)("project_options",{id:(0,n.vX)("id").primaryKey(),projectId:(0,p.nd)("project_id"),categoryId:(0,p.nd)("category_id"),optionId:(0,p.nd)("option_id")},e=>({fk_projectId:(0,c.mt)({columns:[e.projectId],foreignColumns:[u.projectId]}),fk_categoryId:(0,c.mt)({columns:[e.categoryId],foreignColumns:[l.categoryId]}),fk_optionId:(0,c.mt)({columns:[e.optionId],foreignColumns:[y.optionId]})}))},21820:e=>{"use strict";e.exports=require("os")},21919:(e,t,r)=>{"use strict";r.d(t,{Q:()=>s});let o=require("firebase-admin");var a=r.n(o);let n=JSON.parse(process.env.FIREBASE_ADMIN_SDK_KEY);a().apps.length||a().initializeApp({credential:a().credential.cert(n)});let s=a().auth();a().firestore()},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},64939:e=>{"use strict";e.exports=import("pg")},78335:()=>{},96487:()=>{},97262:(e,t,r)=>{"use strict";r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{patchFetch:()=>p,routeModule:()=>d,serverHooks:()=>m,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>u});var a=r(96559),n=r(48088),s=r(37719),i=r(98717),c=e([i]);i=(c.then?(await c)():c)[0];let d=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/profile-projects/route",pathname:"/api/profile-projects",filename:"route",bundlePath:"app/api/profile-projects/route"},resolvedPagePath:"/home/shadilrayyan/code/codecomapass/Project_Collab/app/api/profile-projects/route.ts",nextConfigOutput:"standalone",userland:i}),{workAsyncStorage:l,workUnitAsyncStorage:u,serverHooks:m}=d;function p(){return(0,s.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:u})}o()}catch(e){o(e)}})},98717:(e,t,r)=>{"use strict";r.a(e,async(e,o)=>{try{r.r(t),r.d(t,{GET:()=>d});var a=r(32190),n=r(7462),s=r(13723),i=r(94634),c=r(21919),p=e([n]);async function d(e){try{let t=e.headers.get("authorization"),r=t?.split("Bearer ")[1];if(!r)return a.NextResponse.json({error:"Unauthorized - No token"},{status:401});let o=(await c.Q.verifyIdToken(r)).uid,p=(await n.db.select().from(s.projects).leftJoin(s.teamMembers,(0,i.eq)(s.projects.projectId,s.teamMembers.projectId)).where((0,i.eq)(s.projects.createdByUid,o))).reduce((e,t)=>{let r=e.find(e=>e.projectId===t.projects.projectId);return r?t.team_members&&r.members.push(t.team_members):e.push({...t.projects,members:t.team_members?[t.team_members]:[]}),e},[]),d=await Promise.all(p.map(async e=>{let t=await n.db.select({categoryId:s.projectOptions.categoryId,optionId:s.projectOptions.optionId}).from(s.projectOptions).where((0,i.eq)(s.projectOptions.projectId,e.projectId)),r=await Promise.all(t.map(async e=>{if(null===e.categoryId||null===e.optionId)return null;let t=await n.db.select({categoryName:s.categories.category}).from(s.categories).where((0,i.eq)(s.categories.categoryId,e.categoryId)),r=await n.db.select({optionName:s.categoryOptionValues.optionName}).from(s.categoryOptionValues).where((0,i.eq)(s.categoryOptionValues.optionId,e.optionId));return t.length&&r.length?{categoryName:t[0].categoryName,optionName:r[0].optionName}:null}));return{...e,categories:r.filter(Boolean)}}));return a.NextResponse.json(d)}catch(e){return console.error("Error in /api/profile-projects:",e),a.NextResponse.json({error:"Server error"},{status:500})}}n=(p.then?(await p)():p)[0],o()}catch(e){o(e)}})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[719,996,190],()=>r(97262));module.exports=o})();